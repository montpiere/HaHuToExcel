import requests
from bs4 import BeautifulSoup
import xlsxwriter
import os
import datetime
import time

x = datetime.datetime.now()
datum = x.strftime("%Y-%m-%d")

sorszam = 1
lista_keszites = 0


def read_lines_to_list():
    lines = []
    with open('links.txt', 'r', encoding='utf-8') as file:
        lines = file.readlines()

    # Strip newline characters from each line
    lines = [line.strip() for line in lines]

    return lines


# Használat:
lines_list = read_lines_to_list()
print(lines_list[0])

fajl_nev = 'test.xlsx'
url = lines_list[0]

uzemanyagok_array = ["Benzin", "Dízel", "Benzin/Gáz", "LPG", "CNG", "Hibrid", "Hibrid (Benzin)", "Hibrid (Dízel)", "Elektromos", "Etanol", "Biodízel", "Gáz"]


"""
fix_urls_array = [
    "https://www.hasznaltauto.hu/talalatilista/PDNG2VG3R3NDAEH5S56ACCMX3WNMOVVLEJKWRJMV7INA2ZAIY2LUDNQTFUQP5PPDERF6GLCPBTT5Q47GOIOBB44VXB4ZCFZCKMILAJRHMGFW3NTGFQLZTP5CIF6YCJSQA4WUIBR2HW4B34FDOQKQN5BNKTQK7WL2E5TEHEUWMEG24NGSYYSDHELFKMDD5R6MKJSNROBSXG3X2RWENMHX2VVVUBBXSATHTIXI7SHS533UKZBVHCYHWCK27ITQPCWYFFULETZY23OKCQ35YRAE72CH472ANJYAE4MCVYS6BZOCJT3CKPIYBZIPNTKNGGH45KDQW5XIDMOXZVEYWPLGZVVJXVHOP7GTXPB77YPQBR7JHQIPOSW5ZI7PRGBBL5UNB5SP4SA73YORSCUS5STOV2KVO7W66ZR3WTKQTMMOAGT2BFCV7TF7GWIVGH4MCOCVVD2UA4DJVPLWFOAR4S47CJ6USMSWHS2TQPYLK7Q6LAY4XF673DCAEPAAEVNRTUTELTDIDHIYQIZFGMZFKSJIUS3O3DCWAL2QU4FKANM4FFSGWECLOGJ32X53XVFJD53RCHR2FD7HGGPPP4JCY2FT5ZSW5YOPAKEONBVXJDIL2PVFELRVHNTWBY4QFLMYCBRGHU2RUPL6U64CPHVTIZZSKFOL46R3O3QF6GQRUCBQ3YSR6JXPV6FE3LGGHAXV46R2ZDHTDGBTRINFLCBW6ES6YNFIREYUAN3MLAVSO4CAOOHNUSNW5ZQUKN26CXMUWO7GPATORT4TIJN3E5BEI72RQ77JH4KPZAGHFDNV22LJSJLOGS3HGW2BP5HFQFOA3WUM5K6PPY3GXP72E7LD2CHIVPP7AN7NPDSU",
    "https://www.hasznaltauto.hu/talalatilista/PDNG2VG3V3NDAEH4S56ACCLQ2KNMOVSVSEVFJKKSL6RYKLGB7CZMQ5VCAOEH73Z2ZGQXCDSPFQZ7NTS6YYA3C7ATO4X7EQTEBIBDNZBE5SYMWNUM4URPGNZUVCX5ABXKUGK4QQFHA53SG7USV3DIBPUDDL6C3W7MYVREZURRVTAVKRW2TBSCDMTMZ3APXFCZRMGFWVZF653K7CDY5WU47KQWOSUM5YCM3PTRCWO676LCE26AQE6URUGSX44FBRCOIGJX3QNR4YPB32QTAZ5ECPZ3U4PXADTQQ2YSF3XFZBC7ELFWGWGVR7WEEY6U3QMPP24GBB562XAUPDJFNMWRNPO2S74ZZP3ZO76D6HE6YFHTF6AHLUTQ72AHUJQIKQ7LAOMV7UUH36HAYBKJOZNQ75C3P7W665RXW3KQXMMOAGT2BETV7TF7GKP3O27TETRVNI6REXC2XEXMOG2BLZNH6RR5LMZHMPBVBAP6XZ4BCWFXZ7MJJUWMAA2QWKJSCTOGMUONTCJBFAZTOU2CEWU3RZEWLUGPMCSNVIAFVQ4FIK3ADMIWO447RNO7VMKPSEAXGEXIM6AZ4PSRBL3CXQNGE3XFYEAY7YUEWZA5PORQV4XOKUVTOMDDMDVJRIOWQYGWKOV5DY3HRJ56EOLLGQ3VFML4HZ5O6VYQD6VICAGTLXZGD4X6U3MMI2UK6PRKLJ5DPSPYEONDVBIYK2ATL7AV5A42DEBXJS4GWVZAMBZUS6UJ2ZHLD5LHJY2NSG6XMU4OM6BP4MRLWQRUWJ3S2RGPC4XYKDYAHHVCNR32LJKJLKGS7HOV2BPNCV2HOIGWQM5J6MYYZG7N72OQ5LKBHMU7N4IPQ4UY4VY",
    "https://www.hasznaltauto.hu/talalatilista/PDNG2VG3R3NDAEH5C57QCCNQ3ONMOVSVSEVFJKKSL6RYCDGB7AZMRF3IAHY66HJH3FWZFZMJ4EOHXTS4RYBXF6JC55ARNJIUDIRDNZAV5SYBKG6GBIU4EDJNTIV2ISA5WSJAFTHU4BXMAT6K24MDDNCQIO4ITTK6F2DCILODAZ6GLFOLJELFFCBZANXWGZRNAUTF6TPO5WPBD6O2Q47KWORQWE5IHN5JZMRULUP5XZFNDAAHO5IGAVDYOKQMZHMCEH3YIY6NHV5DIJ4M6SCP52E4P3ADTQQZQ2FLRFZDC7E3HWGWGRQMKBZW5JUQZPXXYMCXWDGJYSIDLFVMWVMHI2S74ZZ74FX46H7XA6AGH7E6EH7UVU5GB2EJSIKQ4KKEWK7VJCF7HVMYVCW4W3XOTF7O3LP623TIVMJWEHILLZB2L2X4S7T3H3W27XFDRVLIZRAHA2PLKUY5ZCHKSLBBTTLMZHMPFVBAX2XZ6B2WF2FPKJ3WMIAR5ACWVWFNGZC4Y2IZ2GFDWZZTGTNIJEVC4ONRRPAV3IMZFKADC4FBFA3CBV7SVZ5L65T3KWZORYZSY5SR6L3TXTWOGVMOK564ZLJ4HDQFDHGQGXUJHD7T5KTNZVHMTSAY2Q52MIDVVGHVSQGAN7CMOFHTYZ4D6ZDDVF6PI7X52CXSIO2RAYN4JM7EYIO4GSNVRD3RL26AU5CUN5R3AYAUBXVJQ3ISFLMBXUBTMOAES3CYU5THARD3ZHNJG3G5YPFG5PDJOLLXNTHRJQYFYZUFW3SOQRE6TIY75WT7FD4ADD2RW25TNSSOLLGS7HOV2BOTCVCH6IGRQO5K6PIY7G7N72OQ5SNCDMK7X6AHNBWI4TA",
    "https://www.hasznaltauto.hu/talalatilista/PDNG2VG3R3NDAEH5S56ACCMX3U2Y7LNKEJK2RUSK7MNA2ZAIY2LUDNQTFUQP5PPDERF6GLCPBTT5Q47GOIOBB44VXB4ZCFZCKMILAJRHMGFW3NTGFQLZTP5CIF6YCJSQA4WUIBR2HW4B34FDOQKQN5BNKTQK7WL2E5TEHEUWMEG24NGSYYSDHELFKMDD5R6MKJSNROBSXG3X2RWENMHX2VVVUBBXSATHTIXI7SHS533UKZBVHCYHWCK27ITQPCWYFFULETZY23OKCQ35YRAE72CH472AWTQBJYYFJRF5DS4ERHWFU2RADSY73CUKOMPY2UHRP3GQG45PRKBRM6W5TLCTPOO456MHO6D77Q7BDH6CNA7P5BNLSR67CMCSX3A3D7EPZEJ67R2WIKCIWKN2VJ2X3W2Y7TLWNCVRGYQ5ANHECKNL7CL6P452RTARXY2UUHLAHQNFXUK2XYKGSDT4NH2QJ6LIYLKPBXBNP6TZMDCSYX36MMJQX4AASRWGKSETOEMQO5TCBDFEZTMUKBESULVZMELYHPKATUVIBVTQU2IK2QJMYVG7M7XN6YVELXWHIWGIWPU6Y54N5R4LDAX7VGC3XFZ4BIZYUKW5CNJOJSVUXOOU5SOIDDKDVJSAOGUY6TKGR5HYTXRJ46GODLGZKVBMT6H55OQVYSDWUIGAPCLXZGF4X4VDNMI24O6HR2PJEA74OYGOFBVFIIO2YSL3BU5AE3DABXNQMGWZZQABZU4WUJ6ZXKDRLXLYKVSC73MY4OM2AP2PBJW4TUURDTKWH7FF75IPAAY6UNWHPJNFJFNI2L452XIF5UEXA5ZDK2BTVLZ55D435X7JH5UNIE5SV5X6B6H77DS2",
    "https://www.hasznaltauto.hu/talalatilista/PDNG2VG3R3NDAEH5S56ACCNXVZ4WZNJKKKCSUVPKNM2JAIIYL4DNSTVUQD4PPDUTFSG3GPBRTRR47GOLOFAMYV7C5ZCV5CCMIHAJVHEEDW3NTBVRLRSP5BQG6UKZUQA5WQIBT2HU4BXMAT6SKUMNBN2QQG7WLG55TAGUSWUGGW4NESA3SPGEJFSNDH4BQM2LSFQ6HSXE33XBKENPHX2VTVMCB3SRTHDJXI6CFS533624Q2TQMAHRFNHUF4HBJMKT2BSF64FMXFDYP6UEQFPNBT6O5EO44AOOGBKMJPI4XFEJ5RNWUIA4XH6YVCTTD6GZB4L6ZUBXHL4KQMLHVXM2YU73G2O7G57PR37YPQZT7BEQN75ANPSQC7KPCSWHA2D4EDZUX6XQ3OI2CIGJN2VZ4XTV277G452DLOORB2YYOAFEUWOFX46J7ZK3BTPBRJYKWUPAQLTNKWWIOG2BLYNH6RR5LEZLMPBVBCP6XZ4BCWZXZ6MFJUWMAA2QWKKSCTOGMUONTCJBFAZTKU2CEWU3RZEGLUGPMCTVVIAFVQ4FIK3ADMIUO7M7XNO3VMKHSHYXGEXPU6A64N4R6L3CXTUGG3XFYEAY7YUEWZDNPOBQVUXOKUVTOMDDMDVJSIOWQYGSKOR5DY2XRJ56EOLLGQ3VFML4HZ5O6VQQD6VICAHDLXZGD4X6U3MMI2UM6PRKLJ5D7QMIGONDVBIYK2ATL7BF5A42DABXJQ4GWVZAEBZUS6UJ2ZHLDZLHJY2NSG63MY4OM6BP4MRJWQSUWJ3SKSH7C5P7UHQAOPCG3HXEUS4TWQNF6OVLUG62EL4P4RVNAZSU46RR6N637UDR2GUDOZKOZYY7RVFI4WI"
]

fix_urls_array = [
    "https://www.hasznaltauto.hu/talalatilista/PDNJ2V25N6ZTMFH6F76AFTCHJDUOLJTJSWTGVUVE3URKO4NJRPARKNWRSJL733Z3G2QXSTGNLZ2VOOPYOC7J7Z4Y6C5NVVZ7JTG3EOXJXAK22HRFP4JOPZEBZZMJ3GFL5CC3V4GJNJ7VJVAJK7QYWT3UX2XZHIZ6JMV2YTI6RY23XPP2FLDZHMGCTT4YTG5L2OSDPP3HHJLHY3D2HE4L62M5ERVQ37YHGVSZ3CDJNQBLXJ4YYKMT2LPRFHVMBFLN334NQT66J6OTB7232VE4WRZ6HRF25JEJXSILTYVZ2JBUIRZRR5RBJ2SVLAOVC72WVZ76G34WX7YVWRSUZMFSKSN5PA6OTWYZ7M6IHGXQOCUYOEQ6QWMZINJOIZHLDUWUI7N27674RMMV73WNUEPPZLT36GLRRT7SLGMFTEKRQTT4SWG574QY37LT2S63MUQPR6TVTPPTMZ7T6PW5ZJFJPYOQ5GX7U6PKYVQFC5LQ7EHJOTV4BOB6OO47LKTU6MCJJK36OY6HDNE2PHAK7EQT2KVI365SY6MQDY6PIUBR66IM2DZFHV6PQOF5HYE2LVWG2SHN37WTTKPKVMS2ZTU2SLDGPOFG3ZP3MTPIICWMPVVLH3KNZQLPCY4GYKJHEM4I7Y52MOLE7RO5X3E65X7QR6ZCA47JRKY46WKZWFMTL2SSHCZ5OOS3QCVVCT2ILSDONXL27SIZVBBHNUWAYWMYRQHNMJCBZSCSKZ7NCBTWQTUU5OVVUHBEHF6XXO3K5YTSVF4GNV24GLE5SURTZG4ZH42ZF2OFZTDS5GNVDTJ3QW4L5SUYXCU3XBSI33ZVLGMTCJDHYVIR7QTNVB34XDYBMLNI3OXWE2GFHCGXNXNUKALXNLK2OSGVBIYYJ3RCVASZCB62QNLPYJEEXDF3VROX6UMH3YHSXNLIF5DLJQNCUJL7KQB34WFWWUEEJ2UTTWUYNPGCMUD5LHPM6RXXXS2XZJENXEZFY2YD3OGIBVHJOG4FA47MLEIJK6WZNBZ3KXC5KZ6TNYRIBSKURME6N4VQJLSQ4KVJWTYVNYULPI5R56C5X7CBRKKGCLZIMKYA443XMOHO7URW53WYNLNSIFORN6XKSR2LRYQU7UHO4FGATUBLQUYAO4FOB5TS7EUX76F45EBNNTRRYGNTYV676TDKFHTFXUBXSD7SAFWYGMQY43S7UL4JPYLWTNND2RVPNKDKXJ7A3Q4RZ3NSNPCD7Q6NVC2YWVOHPDU3BXWUWJO2KWKJXDTOIHRIEWBPYR7KEKE5NTHPE2S2Z37FHC6DZRTGRUKXCJ6Q2WGCL3JTT54EKG722D3OBJCX4X6SHHWO43APPN6HPF7BHDFUALXO6IATZQRLPECTFORZIRXYYAUCCYS4QYAK7HTFARYJKEF7ADRZSYIKSBBXAW6AH6IWLAVCJE2DSIGKHAT3AYXBT6WEPZAJMGPYZQYRN6BJOBJBLXFNNYQYKIZ7ZKV2K3OJLM77JQUTDJO2L4JBMYNVGZHRIZQNELEP663NYAWDF3PGRHBUZYFZXG3PEADODAENIYEEIQL5RDJYDIOM4LYMF4XCUOBAIMYEMAPJWZWICICCNUUBEG7PGKDYCFOAQUQE26O64H7T653QRIW3R3YWWI3VBAFNFXGA5ZLCQRCZD3TQTDQPXOAMAZLFDRHMRMJU3KIC2BXDZ2FQGBPBCZPYUCEUMCZWDHDUANSDQBDWLAH4DXJJI43YFTG7T4EEH3GF227GCGYUJV7U53RYWDRWGL7DLDDKT35CKOEZH4G6Z5UE76DUSL7JXIVI7RW3NC3GLVCKG3G4ERWGGRPHOEMOM4KOA6LWGHU7HVHICRLRCDZJXRJPU5QPQLG2YUZNV7CNORSPDUIGO4BNX6DO3BQPVVRWID7G27JB4ABMG5MKC5AXA4PEH7NZXSY7LD5O47TXP6T7YP7WIX3S6TGGCL4Q",
    "https://www.hasznaltauto.hu/talalatilista/PDNJ2V63N3VTMEH4C56YCKCKXYUI6LMKAYUIYAQF7IVNAMNDGC5NAEBJUP3ED7V5JPFIVBYK2WB7IKI3V24NPGK5LKKNWXPZYOKCYK4TIZMFT22BRGB3YJCPOTDMVRG4MQT5XKYYVX3EO6MZRA3PZ4CA465TEOPKROZNFWXE5FMLF65HN5VDQSJLZVCZZBFZHFGXVN33UHRVMDCVU55GONZNSNSKSEP7UCTCQEZZBZKXB3YQKO4GXB6ZH5462RLLVN3TC5FDW5JSNTH73WLESLIG2G7SRUJKCP4SA46JRNLPOEI57E6MUQNWN7JOVCH2GNZ73G3YW7RF3XBDUJOF4KKIVLC7GSO7Z7MOOGPEQSDXGPQU6AQM3WC24N6HB4UVU3PNW3SZ45P4Z4H2FAHNLYDX3XE37ZDQKEX5ETEKRQ6LZDGG5LXA6ZPMT6B65NCVXJ7T4TPKRW77N57T4GPFMORXQ5HH7VJPMMTXXC5KXWF3PPZW6IWA3HTPPRUI2PSBE4U5YTQMRWUBJHIKJLSIP4VIOAM3CPDZKIPD2PR7537MWXFYMVJJBQIP56U5GJ6ZW3F6WVDTY3J727G77XF7NG6ZACMSXWDEQH6FW5I6ZW5WYAYDH26OT4S5ZRTPCY4CYMOHNVOL5Y5VOOOE7TO3XWJD3L76D5SV6WRDONZV5CNTACZWXUUUOGD3CFWSXWSQJNHF7CPQ2Y3N3EVAQEVGIKBVLVPIQDGCZ2L2QCKZZKFC7WXAD3Q3UULOOS2ODIML5OWK3S5YTAZZ4GBWUVGHENXHJSZMOCU7MSH2E7ESBNPYZ3JUK6EO7C4IRGP3VKMI5COVRJBZW3JMRLZKALQEQM2R6RLVDYYNVL3JX3DLHGGIGXIWFXKIKVO3Z25EVNUD5RH7EJUDLYIILKBU57JCQS5MXMXE272RQ7LPOC5VVSXUNVWBWCRE65KPOPSYW2KQQRDKSOG2TBN6YTVA7IZMAX4M5ZCG3RKAKNZXC4NJBXXGMBFEIYH73FMKMMXZFKGUVFFJXGYV5V2VCZZDR7JFBCQE5NUWGILQMUVW7OX2KTQZI4TTDLVZ5O7JD6CEQELWSI6AMI4RXOWTTHEVVXONOFK3ISB3ULFU2W2MVYKKSD3QPOCTAB3QVYCOAHOCTAG3ZPC2P7HB4OTCLLE5MGBDOWO6P3JRVC22K3SQNZA5ZB53YG5EYEYC4V37IX2LWKVLDWSRNPKHKXKXISYYBZ2F4V7BD3Y73KFPOJIXFXJYNZLDIL23LEX3ZXDVWQEYSC3SHEILXEN4GSVLVKE3VEC7WTZNGYZZXICFF4SXUEKYYJPNKOHTQRIT7LPXVYFTS7YMNEHLGO63YEON6PDEHDHDFEHTQ66APC7QBHPYFDDG63IY3EMD2O6AAGNOIK6BZ4RIYBVQ5VRBYYBDYFLAE2DW6IG6DRJYKYBYATE5AK4YM5QJFIKNVQDUJGMBJWHL5QCOR2O5VQTOOUBSS3HZKHOSYTKLKH52NZ462RUCVDJXGFN6SIULC4BIGZR4L3NWEDIMTN4KDMOT3AXSYLS7IEGMEAILRUIIRAT2D6TQGQ4ZYXQYL2OFLMCQCZQIIAPOWZWICICCNUUBEG7HSFF4BAXAIKMC5NA7PD7JBUPIF2B6MP6NQSA5QKBDAV5QXPTAUUOG4M6MD5TBCUILRLEIYMETTFSGBOZMMYE4PFY2AIG44JBRDAISJQ3PJE5OQAGJXQHWZMTLRHLSOQW4R7H6IQMGELOW4YGVXILI7JZXFR4BDVXXWEOHGJ3H2E7NJKOIJD32IZVSFRUT6JXYU7HLW7MSMGTVD323FMSJ3DFIRZTRDDZDRJ4D4XEOHPOHF2YCQDSCP2Z7Q4QKTLH2EVJMULCV6RKHCZXW3MAT3DFLWYMF5FV5GAHZW73EFQABQ3RRIF2BWA4PRT7G436AHFW63VT7O46K75TJ65P7ALGYME5N",
    "https://www.hasznaltauto.hu/talalatilista/PDNG2VG3R3NDAEH5C57QCCNQ3ONMOVSVSEVFJKKSL6RYCDGB7AZMRF3IAHY66HJH3FWZFZMJ4EOHXTS4RYBXF6JC55ARNJIUDIRDNZAV5SYBKG6GBIU4EDJNTIV2ISA5WSJAFTHU4BXMAT6K24MDDNCQIO4ITTK6F2DCILODAZ6GLFOLJELFFCBZANXWGZRNAUTF6TPO5WPBD6O2Q47KWORQWE5IHN5JZMRULUP5XZFNDAAHO5IGAVDYOKQMZHMCEH3YIY6NHV5DIJ4M6SCP52E4P3ADTQQZQ2FLRFZDC7E3HWGWGRQMKBZW5JUQZPXXYMCXWDGJYSIDLFVMWVMHI2S74ZZ74FX46H7XA6AGH7E6EH7UVU5GB2EJSIKQ4KKEWK7VJCF7HVMYVCW4W3XOTF7O3LP623TIVMJWEHILLZB2L2X4S7T3H3W27XFDRVLIZRAHA2PLKUY5ZCHKSLBBTTLMZHMPFVBAX2XZ6B2WF2FPKJ3WMIAR5ACWVWFNGZC4Y2IZ2GFDWZZTGTNIJEVC4ONRRPAV3IMZFKADC4FBFA3CBV7SVZ5L65T3KWZORYZSY5SR6L3TXTWOGVMOK564ZLJ4HDQFDHGQGXUJHD7T5KTNZVHMTSAY2Q52MIDVVGHVSQGAN7CMOFHTYZ4D6ZDDVF6PI7X52CXSIO2RAYN4JM7EYIO4GSNVRD3RL26AU5CUN5R3AYAUBXVJQ3ISFLMBXUBTMOAES3CYU5THARD3ZHNJG3G5YPFG5PDJOLLXNTHRJQYFYZUFW3SOQRE6TIY75WT7FD4ADD2RW25TNSSOLLGS7HOV2BOTCVCH6IGRQO5K6PIY7G7N72OQ5SNCDMK7X6AHNBWI4TA",
    "https://www.hasznaltauto.hu/talalatilista/PDNG2VG3R3NDAEH5S56ACCMX3U2Y7LNKEJK2RUSK7MNA2ZAIY2LUDNQTFUQP5PPDERF6GLCPBTT5Q47GOIOBB44VXB4ZCFZCKMILAJRHMGFW3NTGFQLZTP5CIF6YCJSQA4WUIBR2HW4B34FDOQKQN5BNKTQK7WL2E5TEHEUWMEG24NGSYYSDHELFKMDD5R6MKJSNROBSXG3X2RWENMHX2VVVUBBXSATHTIXI7SHS533UKZBVHCYHWCK27ITQPCWYFFULETZY23OKCQ35YRAE72CH472AWTQBJYYFJRF5DS4ERHWFU2RADSY73CUKOMPY2UHRP3GQG45PRKBRM6W5TLCTPOO456MHO6D77Q7BDH6CNA7P5BNLSR67CMCSX3A3D7EPZEJ67R2WIKCIWKN2VJ2X3W2Y7TLWNCVRGYQ5ANHECKNL7CL6P452RTARXY2UUHLAHQNFXUK2XYKGSDT4NH2QJ6LIYLKPBXBNP6TZMDCSYX36MMJQX4AASRWGKSETOEMQO5TCBDFEZTMUKBESULVZMELYHPKATUVIBVTQU2IK2QJMYVG7M7XN6YVELXWHIWGIWPU6Y54N5R4LDAX7VGC3XFZ4BIZYUKW5CNJOJSVUXOOU5SOIDDKDVJSAOGUY6TKGR5HYTXRJ46GODLGZKVBMT6H55OQVYSDWUIGAPCLXZGF4X4VDNMI24O6HR2PJEA74OYGOFBVFIIO2YSL3BU5AE3DABXNQMGWZZQABZU4WUJ6ZXKDRLXLYKVSC73MY4OM2AP2PBJW4TUURDTKWH7FF75IPAAY6UNWHPJNFJFNI2L452XIF5UEXA5ZDK2BTVLZ55D435X7JH5UNIE5SV5X6B6H77DS2",
    "https://www.hasznaltauto.hu/talalatilista/PDNG2VG3R3NDAEH5S56ACCNXVZ4WZNJKKKCSUVPKNM2JAIIYL4DNSTVUQD4PPDUTFSG3GPBRTRR47GOLOFAMYV7C5ZCV5CCMIHAJVHEEDW3NTBVRLRSP5BQG6UKZUQA5WQIBT2HU4BXMAT6SKUMNBN2QQG7WLG55TAGUSWUGGW4NESA3SPGEJFSNDH4BQM2LSFQ6HSXE33XBKENPHX2VTVMCB3SRTHDJXI6CFS533624Q2TQMAHRFNHUF4HBJMKT2BSF64FMXFDYP6UEQFPNBT6O5EO44AOOGBKMJPI4XFEJ5RNWUIA4XH6YVCTTD6GZB4L6ZUBXHL4KQMLHVXM2YU73G2O7G57PR37YPQZT7BEQN75ANPSQC7KPCSWHA2D4EDZUX6XQ3OI2CIGJN2VZ4XTV277G452DLOORB2YYOAFEUWOFX46J7ZK3BTPBRJYKWUPAQLTNKWWIOG2BLYNH6RR5LEZLMPBVBCP6XZ4BCWZXZ6MFJUWMAA2QWKKSCTOGMUONTCJBFAZTKU2CEWU3RZEGLUGPMCTVVIAFVQ4FIK3ADMIUO7M7XNO3VMKHSHYXGEXPU6A64N4R6L3CXTUGG3XFYEAY7YUEWZDNPOBQVUXOKUVTOMDDMDVJSIOWQYGSKOR5DY2XRJ56EOLLGQ3VFML4HZ5O6VQQD6VICAHDLXZGD4X6U3MMI2UM6PRKLJ5D7QMIGONDVBIYK2ATL7BF5A42DABXJQ4GWVZAEBZUS6UJ2ZHLDZLHJY2NSG63MY4OM6BP4MRJWQSUWJ3SKSH7C5P7UHQAOPCG3HXEUS4TWQNF6OVLUG62EL4P4RVNAZSU46RR6N637UDR2GUDOZKOZYY7RVFI4WI"
]
menu_list = [
    "1. URL megadása",
    "2. Hyundai i30 (2015 - 2020)",
    "3. Kia Ceed (2015 - 2020)",
    "4. Ford Focus (2015 - 2020)",
    "5. Mazda 3 (2015 - 2020)",
    "6. Honda Civic (2015 - 2020)",
    "7. Lista készítése - Hyundai, Kia, Ford, Mazda, Honda"
]

uzemanyag_array = ["Benzin", "Dízel", "Benzin/Gáz", "LPG", "CNG", "Hibrid", "Hibrid (Benzin)", "Hibrid (Dízel)", "Elektromos", "Etanol", "Biodízel", "Gáz"]

print("- Verzió: 2.9 -")
for i in range(len(menu_list)):
    print(menu_list[i])
print("---------------------------------------------------------------")
opc = input("Valasz: ")
opc = int(opc)

# ---Menu vizsgalat ----------------------------------------------------------------------------------------------------
if opc == 1:
    url = input("URL megadása: ")
    fajl_nev = input("Fájl név: ")
    fajl_nev = fajl_nev + " - " + datum + '.xlsx'
elif opc == 2:
    url = fix_urls_array[0]
    fajl_nev = menu_list[opc-1][3:] + " - " + datum + '.xlsx'
elif opc == 3:
    url = fix_urls_array[1]
    fajl_nev = menu_list[opc-1][3:] + " - " + datum + '.xlsx'
elif opc == 4:
    url = fix_urls_array[2]
    fajl_nev = menu_list[opc-1][3:] + " - " + datum + '.xlsx'
elif opc == 5:
    url = fix_urls_array[3]
    fajl_nev = menu_list[opc-1][3:] + " - " + datum + '.xlsx'
elif opc == 6:
    url = fix_urls_array[4]
    fajl_nev = menu_list[opc-1][3:] + " - " + datum + '.xlsx'
elif opc == 7:
    fajl_nev = 'Hyundaikiafordmazdahon - ' + datum + '.xlsx'
    lista_keszites = 1
"""
# EXCEL
workbook = xlsxwriter.Workbook('e:\Autovasarlas\Excel tablak\\' + fajl_nev)
worksheet = workbook.add_worksheet()

# excel formatting
worksheet.set_row(0, 21)
worksheet.set_column(0, 1, 13)
worksheet.set_column(2, 2, 97.6)
worksheet.set_column(3, 10, 18)
worksheet.set_column('G:G', 10)
worksheet.hide_gridlines(2)
worksheet.autofilter('A1:K1')
worksheet.freeze_panes(1, 0)

head_style = workbook.add_format(
    {'bold': 1, 'underline': 1, 'font_size': 11, 'align': 'center', 'valign': 'vcenter', 'bg_color': '#e6e6e6',
     'border': 1, 'border_color': '#aaaaaa'})
kivitel_style = workbook.add_format({'border': 1, 'border_color': '#aaaaaa'})
link_style = workbook.add_format(
    {'font_color': 'blue', 'underline': 1, 'align': 'left', 'border': 1, 'border_color': '#aaaaaa'})
center_align_style = workbook.add_format({'align': 'center', 'border': 1, 'border_color': '#aaaaaa'})
km_style = workbook.add_format({'align': 'center', 'num_format': '# ##0" km"', 'border': 1, 'border_color': '#aaaaaa'})
vetelar_style = workbook.add_format(
    {'align': 'center', 'num_format': '# ##,,0 Ft', 'border': 1, 'border_color': '#aaaaaa'})
le_style = workbook.add_format({'align': 'center', 'num_format': '# ##0" LE"', 'border': 1, 'border_color': '#aaaaaa'})
kw_style = workbook.add_format({'align': 'center', 'num_format': '# ##0" KW"', 'border': 1, 'border_color': '#aaaaaa'})
kbcm_style = workbook.add_format(
    {'align': 'center', 'num_format': '# ##0" cm³"', 'border': 1, 'border_color': '#aaaaaa'})
evjarat_style = workbook.add_format(
    {'align': 'center', 'border': 1, 'border_color': '#aaaaaa'})
honap_style = workbook.add_format(
    {'align': 'center', 'border': 1, 'border_color': '#aaaaaa'})

worksheet.write('A1', 'Márka', head_style)
worksheet.write('B1', 'Modell', head_style)
worksheet.write('C1', 'Kivitel', head_style)
worksheet.write('D1', 'Vételár', head_style)
worksheet.write('E1', 'Üzemanyag', head_style)
worksheet.write('F1', 'Évjárat', head_style)
worksheet.write('G1', 'Hónap', head_style)
worksheet.write('H1', 'Futott km', head_style)
worksheet.write('I1', 'Hengerűrtartalom', head_style)
worksheet.write('J1', 'LE', head_style)
worksheet.write('K1', 'KW', head_style)


# F U N C T I O N S
def auto_adatok_feldolgozasa(adat, sorsz):

    find_link = adat.find('h3')
    nev_info = find_link.a
    nev = nev_info.get_text()

    marka = nev.split()[0]
    modell = nev.split()[1]
    kivitel = str(nev[((len(marka)+len(modell))+2):])
    link = nev_info['href']

    adatok = adat.find_all(class_="info")

    ev = '-'
    honap = '-'
    uzemanyag = '-'
    km = '-'
    kbcm = '-'
    le = '-'
    kw = '-'

    # - Vétel ár -------------------------------------
    try:
        vetelar = adat.find(class_="pricefield-primary").get_text()
    except Exception as e:
        print("Akciós hiba:", e)
        vetelar = adat.find(class_="pricefield-primary-highlighted").get_text()

    vetelar = vetelar[:-3]
    vetelar = vetelar.replace(u'\xa0', u'')
    try:
        vetelar = int(vetelar)
    except Exception as e:
        print("Vételár hiba:", e)
        vetelar = '-'

    for i in range(len(adatok)):
        info_adat = adatok[i]
        info_adat = info_adat.get_text()
        info_adat = info_adat.replace(u',', u'')
        info_adat = info_adat.replace(u'\xa0', u'')

        if info_adat in uzemanyagok_array:
            uzemanyag = info_adat

        elif 'km' in info_adat:
            km = info_adat[:-2]
            km = int(km)

        elif 'cm³' in info_adat:
            kbcm = info_adat[:-3]
            kbcm = int(kbcm)

        elif 'LE' in info_adat:
            le = info_adat[:-2]
            le = int(le)

        elif 'kW' in info_adat:
            kw = info_adat[:-2]
            kw = int(kw)
        else:
            evjarat = info_adat
            evjarat = evjarat.replace(u'/', u'')
            ev = int(evjarat[0:4])
            if len(evjarat) > 4:
                honap = int(evjarat[4:])
            else:
                honap = '-'

    print(" ")
    print(str(sorsz) + ".")
    print("-----------------------------------------------------------------------------------------------------------")
    print("Márka: " + marka)
    print("Modell: " + modell)
    print("Kivitel: " + kivitel)
    print(str(vetelar) + " Ft, " + uzemanyag + ", " + str(ev) + "/" + str(honap) + ", " + str(km) + " km, " + str(kbcm) + " cm³, " + str(
        le) + " LE, " + str(kw) + " kW")
    print("Link: " + link)

    worksheet.write(sorsz, 0, marka, center_align_style)
    worksheet.write(sorsz, 1, modell, center_align_style)
    worksheet.write_url(sorsz, 2, link, link_style, string=kivitel)
    worksheet.write(sorsz, 3, vetelar, vetelar_style)
    worksheet.write(sorsz, 4, uzemanyag, center_align_style)
    worksheet.write(sorsz, 5, ev, evjarat_style)
    worksheet.write(sorsz, 6, honap, honap_style)
    worksheet.write(sorsz, 7, km, km_style)
    worksheet.write(sorsz, 8, kbcm, kbcm_style)
    worksheet.write(sorsz, 9, le, le_style)
    worksheet.write(sorsz, 10, kw, kw_style)


def talalati_sor_feldolgozasa(hird_tipus, sor):
    row = sor
    for i in range(len(hird_tipus)):
        auto = hird_tipus[i]
        auto_adatok_feldolgozasa(auto, row)
        row += 1
    global sorszam
    sorszam = row


def url_feldolgozasa(hirdetesi_oldal):
    talalati_lista = hirdetesi_oldal.find(class_="list-view")
    auto_talalati_sor = talalati_lista.select('div[class*="row talalati-sor"]')
    talalati_sor_feldolgozasa(auto_talalati_sor, sorszam)


def tobboldal_vizsgalat(url_exam):
    page = requests.get(url_exam)
    soup = BeautifulSoup(page.content, 'html.parser')
    paginations = soup.find(class_="pagination")
    url_feldolgozasa(soup)
    if paginations != None:
        paginations_hossz = len(paginations)
        last_pagination = paginations_hossz - 3
        last_pagination_num = paginations.contents[last_pagination].a
        last_pagination_num = int(last_pagination_num.get_text())
        for i in range(2, last_pagination_num + 1):
            link = url_exam + "/page" + str(i)
            paginations_page = requests.get(link)
            paginations_soup = BeautifulSoup(paginations_page.content, 'html.parser')
            url_feldolgozasa(paginations_soup)


# main
start_time = time.time()
print("Program running...")
try:
    tobboldal_vizsgalat(url)
except Exception as e:
    print(f"MAIN error: {e}")

workbook.close()
print("")
print("A fájl elkészült. " + fajl_nev + " - excel fájl megnyitása...")

command = 'start excel.exe "e:\Autovasarlas\Excel tablak\\%s"' % (fajl_nev)
os.system(command)
print("")
print("Running time :  %s seconds" % (time.time() - start_time))